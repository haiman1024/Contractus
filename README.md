# Contractus Programming Language

[![Build Status](https://github.com/contractus-lang/contractus/workflows/CI/badge.svg)](https://github.com/contractus-lang/contractus/actions)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Tests](https://img.shields.io/badge/tests-51%20passing-brightgreen.svg)](https://github.com/contractus-lang/contractus)

Contractus æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ï¼Œä¸“ä¸ºè‡ªä¸¾è®¾è®¡ï¼Œé‡‡ç”¨å®ç”¨ä¸»ä¹‰çš„è®¾è®¡å“²å­¦ã€‚é€šè¿‡ C è½¬è¯‘å®ç°å¿«é€ŸåŸå‹éªŒè¯ï¼Œæœ€ç»ˆå®ç°å®Œå…¨è‡ªä¸¾ã€‚

## ğŸ¯ è®¾è®¡ç›®æ ‡

- **è‡ªä¸¾ä¼˜å…ˆ**ï¼šè¯­è¨€è®¾è®¡ä»ä¸€å¼€å§‹å°±è€ƒè™‘è‡ªä¸¾éœ€æ±‚
- **ç³»ç»Ÿç¼–ç¨‹**ï¼šé›¶æˆæœ¬æŠ½è±¡ï¼Œå¯é¢„æµ‹çš„æ€§èƒ½
- **å®ç”¨ä¸»ä¹‰**ï¼šåŠŸèƒ½ä¼˜å…ˆäºå®Œç¾ï¼Œå¯å®ç°æ€§ä¼˜äºç†è®ºå®Œç¾
- **å¢é‡å¼€å‘**ï¼šé€šè¿‡ C è½¬è¯‘å®ç°å¿«é€ŸåŸå‹éªŒè¯

## ğŸš€ ç‰¹æ€§

### å·²å®ç°

- âœ… **è¯æ³•åˆ†æå™¨**ï¼šé«˜æ•ˆçš„æ‰‹å†™è¯æ³•åˆ†æå™¨ï¼Œæ”¯æŒæ‰€æœ‰æ ¸å¿ƒè¯­æ³•
- âœ… **ç»“æ„ä½“**ï¼šå®Œæ•´çš„ç»“æ„ä½“å®šä¹‰å’Œå­—é¢é‡è¯­æ³•
- âœ… **æ•°ç»„**ï¼šå›ºå®šå¤§å°æ•°ç»„ `[T; N]` å’ŒåŠ¨æ€æ•°ç»„ `[T]`
- âœ… **For å¾ªç¯**ï¼šèŒƒå›´å¾ªç¯ `for i in 0..10` å’Œæ•°ç»„éå† `for item in arr`
- âœ… **åŸºç¡€ç±»å‹**ï¼ši32, bool, u8, æŒ‡é’ˆ, ç»“æ„ä½“
- âœ… **æ³¨é‡Š**ï¼šå•è¡Œæ³¨é‡Š `//`

### è®¡åˆ’ä¸­

- ğŸ”„ **è¯­æ³•åˆ†æå™¨**ï¼šé€’å½’ä¸‹é™ + Pratt parsing
- ğŸ”„ **è¯­ä¹‰åˆ†æ**ï¼šç±»å‹æ£€æŸ¥å’Œåç§°è§£æ
- ğŸ”„ **ä»£ç ç”Ÿæˆ**ï¼šC è½¬è¯‘åç«¯
- ğŸ”„ **æ ‡å‡†åº“**ï¼šåŸºç¡€ I/O å’Œå†…å­˜ç®¡ç†
- ğŸ”„ **è‡ªä¸¾**ï¼šç”¨ Contractus é‡å†™ç¼–è¯‘å™¨

## ğŸ“– è¯­æ³•ç¤ºä¾‹

### Hello World

```contractus
fn main() -> i32 {
    print(42);
    return 0;
}
```

### ç»“æ„ä½“å’Œå‡½æ•°

```contractus
struct Point {
    x: i32,
    y: i32,
}

fn add_points(a: Point, b: Point) -> Point {
    let result: Point = Point {
        x: a.x + b.x,
        y: a.y + b.y,
    };
    return result;
}

fn main() -> i32 {
    let p1 = Point { x: 10, y: 20 };
    let p2 = Point { x: 30, y: 40 };
    let sum = add_points(p1, p2);

    print(sum.x);  // è¾“å‡º 40
    return 0;
}
```

### For å¾ªç¯

```contractus
fn sum_array(arr: [i32; 5]) -> i32 {
    let total = 0;
    for item in arr {
        total = total + item;
    }
    return total;
}

fn main() -> i32 {
    // èŒƒå›´å¾ªç¯
    for i in 0..10 {
        print(i);
    }

    // æ•°ç»„éå†
    let numbers: [i32; 5] = [1, 2, 3, 4, 5];
    let sum = sum_array(numbers);

    return 0;
}
```

## ğŸ› ï¸ æ„å»ºå’Œä½¿ç”¨

### å‰ç½®è¦æ±‚

- Rust 1.70+ (ç”¨äºæ„å»ºç¼–è¯‘å™¨)
- GCC æˆ– Clang (ç”¨äºç¼–è¯‘ç”Ÿæˆçš„ C ä»£ç )

### æ„å»º

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/contractus-lang/contractus.git
cd contractus

# æ„å»ºç¼–è¯‘å™¨
cargo build --release

# è¿è¡Œæµ‹è¯• (51ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡)
cargo test
```

### ä½¿ç”¨ç¼–è¯‘å™¨

```bash
# ç¼–è¯‘ Contractus ç¨‹åº (å½“å‰æ˜¾ç¤ºè¯æ³•åˆ†æç»“æœ)
./target/release/contractus examples/hello.ctx

# æŸ¥çœ‹ç»“æ„ä½“ç¨‹åºçš„è¯æ³•åˆ†æ
./target/release/contractus examples/struct_demo.ctx

# æŸ¥çœ‹ for å¾ªç¯ç¨‹åºçš„è¯æ³•åˆ†æ
./target/release/contractus examples/for_loop_demo.ctx
```

### å½“å‰è¾“å‡ºç¤ºä¾‹

```bash
$ ./target/release/contractus examples/hello.ctx
Contractus Compiler v0.1.0
Compiling: examples/hello.ctx
=== Tokens ===
  0: Token { kind: Fn, span: Span { start: 22, end: 24, line: 2, column: 2 } }
  1: Token { kind: Ident("main"), span: Span { start: 25, end: 29, line: 2, column: 5 } }
  2: Token { kind: LeftParen, span: Span { start: 29, end: 30, line: 2, column: 9 } }
  ...
Total tokens: 17
```

## ğŸ§ª æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼Œ**51 ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡**ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cargo test
```

# è¿è¡Œå•å…ƒæµ‹è¯•
cargo test --lib

# è¿è¡Œé›†æˆæµ‹è¯•
cargo test --test lexer_integration_tests

# è¿è¡Œè¾¹ç•Œæƒ…å†µæµ‹è¯•
cargo test --test lexer_edge_cases

# è¿è¡Œç‰¹å®šæµ‹è¯•
cargo test test_for_loop_tokens
```

### æµ‹è¯•è¦†ç›–

- âœ… **å•å…ƒæµ‹è¯•** (14ä¸ª)ï¼šè¯æ³•åˆ†æå™¨å†…éƒ¨å®ç°
- âœ… **é›†æˆæµ‹è¯•** (21ä¸ª)ï¼šå®Œæ•´åŠŸèƒ½æµ‹è¯•
- âœ… **è¾¹ç•Œæƒ…å†µæµ‹è¯•** (16ä¸ª)ï¼šé”™è¯¯å¤„ç†å’Œæç«¯æƒ…å†µ
- âœ… **æ€§èƒ½æµ‹è¯•**ï¼šå¤§è¾“å…¥å¤„ç† (5000+ tokens)
- âœ… **MVP ç¨‹åºæµ‹è¯•**ï¼šå®Œæ•´çš„ç¤ºä¾‹ç¨‹åºè§£æ

### æµ‹è¯•ç»“æœ

```
running 51 tests
test result: ok. 51 passed; 0 failed; 0 ignored; 0 measured
```

### å¢å¼ºæµ‹è¯•è¦†ç›– (æ–°å¢)

ä¸ºäº†æ›´å¥½åœ°æ”¯æŒæµ‹è¯•é©±åŠ¨å¼€å‘ï¼Œæˆ‘ä»¬æœ€è¿‘å¢å¼ºäº†æµ‹è¯•è¦†ç›–èŒƒå›´ï¼Œæ–°å¢äº†ä»¥ä¸‹æµ‹è¯•æ–‡ä»¶ï¼š

- `for_loop_test.rs` - ä¸“é—¨æµ‹è¯•forå¾ªç¯åŠŸèƒ½
- `match_test.rs` - ä¸“é—¨æµ‹è¯•matchè¡¨è¾¾å¼
- `closure_test.rs` - ä¸“é—¨æµ‹è¯•é—­åŒ…åŠŸèƒ½
- `complex_types_test.rs` - æµ‹è¯•å¤æ‚ç±»å‹ç³»ç»Ÿ
- `edge_cases_test.rs` - æµ‹è¯•è¾¹ç•Œæƒ…å†µå’Œå¤æ‚åœºæ™¯
- `performance_test.rs` - æµ‹è¯•ç¼–è¯‘å™¨æ€§èƒ½

è¿™äº›æµ‹è¯•æ–‡ä»¶å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨å®ç°è¯­æ³•åˆ†æå™¨æ—¶é‡‡ç”¨æµ‹è¯•é©±åŠ¨å¼€å‘æ–¹æ³•ï¼Œç¡®ä¿æ¯ä¸ªè¯­è¨€ç‰¹æ€§éƒ½èƒ½è¢«æ­£ç¡®è§£æã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
contractus/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib.rs          # åº“å…¥å£
â”‚   â”œâ”€â”€ main.rs         # ç¼–è¯‘å™¨ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ lexer.rs        # è¯æ³•åˆ†æå™¨
â”‚   â”œâ”€â”€ parser.rs       # è¯­æ³•åˆ†æå™¨ (å¾…å®ç°)
â”‚   â”œâ”€â”€ sema.rs         # è¯­ä¹‰åˆ†æå™¨ (å¾…å®ç°)
â”‚   â”œâ”€â”€ mir.rs          # ä¸­é—´è¡¨ç¤º (å¾…å®ç°)
â”‚   â””â”€â”€ codegen.rs      # ä»£ç ç”Ÿæˆå™¨ (å¾…å®ç°)
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ lexer_tests.rs              # åŸºç¡€åŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ lexer_integration_tests.rs  # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ lexer_edge_cases.rs         # è¾¹ç•Œæƒ…å†µæµ‹è¯•
â”‚   â”œâ”€â”€ for_loop_test.rs            # Forå¾ªç¯åŠŸèƒ½æµ‹è¯• (æ–°å¢)
â”‚   â”œâ”€â”€ match_test.rs               # Matchè¡¨è¾¾å¼æµ‹è¯• (æ–°å¢)
â”‚   â”œâ”€â”€ closure_test.rs             # é—­åŒ…åŠŸèƒ½æµ‹è¯• (æ–°å¢)
â”‚   â”œâ”€â”€ complex_types_test.rs       # å¤æ‚ç±»å‹æµ‹è¯• (æ–°å¢)
â”‚   â”œâ”€â”€ edge_cases_test.rs          # è¾¹ç•Œæƒ…å†µæµ‹è¯• (æ–°å¢)
â”‚   â””â”€â”€ performance_test.rs         # æ€§èƒ½æµ‹è¯• (æ–°å¢)
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ hello.ctx       # Hello World
â”‚   â”œâ”€â”€ struct_demo.ctx # ç»“æ„ä½“æ¼”ç¤º
â”‚   â””â”€â”€ for_loop_demo.ctx # å¾ªç¯æ¼”ç¤º
â”œâ”€â”€ .kiro/
â”‚   â””â”€â”€ specs/          # è¯­è¨€è®¾è®¡è§„èŒƒ
â””â”€â”€ docs/               # æ–‡æ¡£
```

## ğŸ“Š å½“å‰çŠ¶æ€

### å®ç°è¿›åº¦

- âœ… **è¯æ³•åˆ†æå™¨** (100% å®Œæˆ)
- ğŸ”„ **è¯­æ³•åˆ†æå™¨** (0% - ä¸‹ä¸€é˜¶æ®µ)
- ğŸ“‹ **è¯­ä¹‰åˆ†æå™¨** (0% - è®¡åˆ’ä¸­)
- ğŸ“‹ **ä»£ç ç”Ÿæˆå™¨** (0% - è®¡åˆ’ä¸­)

### æµ‹è¯•è¦†ç›–

| ç»„ä»¶ | æµ‹è¯•æ•°é‡ | é€šè¿‡ç‡ | è¦†ç›–èŒƒå›´ |
|------|----------|--------|----------|
| è¯æ³•åˆ†æå™¨ | 51 | 100% | å®Œæ•´è¦†ç›– |
| è¯­æ³•åˆ†æå™¨ | 0 | - | å¾…å®ç° |
| è¯­ä¹‰åˆ†æå™¨ | 0 | - | å¾…å®ç° |
| ä»£ç ç”Ÿæˆå™¨ | 0 | - | å¾…å®ç° |

### æ€§èƒ½æŒ‡æ ‡

- **ç¼–è¯‘æ—¶é—´**: 3.35 ç§’
- **å¤§è¾“å…¥å¤„ç†**: 5000+ tokens < 100ms
- **å†…å­˜æ•ˆç‡**: é¢„åˆ†é…ç­–ç•¥ï¼Œé›¶æ‹·è´å­—ç¬¦ä¸²å¤„ç†
- **é”™è¯¯æ¢å¤**: ç²¾ç¡®ä½ç½®è·Ÿè¸ªï¼Œå‹å¥½é”™è¯¯æ¶ˆæ¯

## ğŸ¯ å¼€å‘è·¯çº¿å›¾

### Phase 1: è¯æ³•åˆ†æå™¨ âœ… (å·²å®Œæˆ - 2024å¹´1æœˆ)

- [x] åŸºç¡€ token è¯†åˆ« (å…³é”®å­—ã€æ ‡è¯†ç¬¦ã€å­—é¢é‡)
- [x] è¿ç®—ç¬¦è¯†åˆ« (ç®—æœ¯ã€æ¯”è¾ƒã€èµ‹å€¼ã€ç‰¹æ®Š)
- [x] åˆ†éš”ç¬¦è¯†åˆ« (æ‹¬å·ã€å¤§æ‹¬å·ã€æ ‡ç‚¹ç¬¦å·)
- [x] å­—ç¬¦ä¸²å’Œæ•°å­—å­—é¢é‡è§£æ
- [x] å•è¡Œæ³¨é‡Šå¤„ç† (`//`)
- [x] é”™è¯¯å¤„ç†å’Œç²¾ç¡®ä½ç½®è·Ÿè¸ª
- [x] æ€§èƒ½ä¼˜åŒ– (ç›´æ¥å­—èŠ‚æ“ä½œã€é¢„åˆ†é…)
- [x] å®Œæ•´æµ‹è¯•å¥—ä»¶ (51ä¸ªæµ‹è¯•ï¼Œ100%é€šè¿‡ç‡)

### Phase 2: è¯­æ³•åˆ†æå™¨ ğŸ”„ (è¿›è¡Œä¸­)

- [ ] é€’å½’ä¸‹é™è§£æå™¨
- [ ] è¡¨è¾¾å¼è§£æ (Pratt parsing)
- [ ] è¯­å¥è§£æ
- [ ] AST æ„å»º
- [ ] é”™è¯¯æ¢å¤
- [ ] æµ‹è¯•é©±åŠ¨å¼€å‘ (ä½¿ç”¨æ–°å¢çš„æµ‹è¯•æ–‡ä»¶)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·æŸ¥çœ‹ [CONTRIBUTING.md](CONTRIBUTING.md) äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚

### å¼€å‘æµç¨‹

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- æ„Ÿè°¢ Rust ç¤¾åŒºæä¾›çš„ä¼˜ç§€å·¥å…·å’Œåº“
- æ„Ÿè°¢ Zig é¡¹ç›®çš„è‡ªä¸¾ç­–ç•¥å¯å‘
- æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…å’Œæµ‹è¯•è€…

## ğŸ“š æ–‡æ¡£

- [è¯­è¨€è§„èŒƒ](docs/language-spec.md)
- [ç¼–è¯‘å™¨æ¶æ„](docs/compiler-architecture.md)
- [è‡ªä¸¾è®¡åˆ’](docs/bootstrapping.md)
- [API æ–‡æ¡£](https://docs.rs/contractus)

---

**"The best language is the one that gets implemented."** - å®è·µå‡ºçœŸçŸ¥